# Summary of Computer Networking

## Program Examples
- Socket: https://realpython.com/python-sockets/

## Basics
- Performance:
	- Speed, bandwidth, throughput, delay/latency, rtt;
- Network structure;
	- Edge: client-server, P2P;
	- Core: packet-switching (realized by router);
- 5 layers;
	- Physical layer:
		- Device: repeater;
	- Data link layer: frame;
		- PPP; CSMA/CD; Ethernet;
		- Device: bridge;
	- Network layer: Router;
		- IP: ARP;
		- Device: router;
	- Transport layer: TCP segment; UDP datagram;
		- TCP/UDP;
		- Device: gateway;
	- Application layer: message;
		- HTTP, SMTP, DNS, RTP

## Physical Layer
- Protocol: 10 Base T, 802.11 (Wifi)
- Protocol Unit Data: Bits
- Addressing: n/a
- Devices: Cables (copper/fiber)
	- Copper twisted pair cables: Cat5, Cat5e, Cat6; problem: crosstalk (RJ45)
	- Fiber: optical fibers
	- Hub (for LAN)
- Technology:
	- Modulation;
	- Duplexing;
	- Multiplexing: FDM, WDM, CDM, CDMA;
- Broadband:
	- ADSL, HFC, FTTx;

## Data-link Layer
- Generally two types:
	- PPP (Point-to-point): about frame;
	- Ethernet for LAN; (802.3)
- Protocol Unit Data: Frames
	- Preamble (8 bytes)
	- Destination address (6-bytes), will change along routing
	- Source address (6)
	- Tag (4)
	- Ether-type (2)
	- Payload (0-1500)
	- FCS (4): CRC (Cyclic Redundancy Check)
- Type I: PPP;
	- PPPoE (PPP over Ethernet);
- Type II: Broadcast-based;
	- Protocols: Ethernet, Wi-Fi (802.11 family)
	- CSMA/CD (Carrier Sence Multiple Access with Collision Detection): whether communications channels are clear, free to transmit data, all use **Manchester coding**;
	- Devices: switch (for LAN)
		- Adaptor; NIC (Network Interface Card); OUI (organizationally unique identifier) for MAC address;
		- **Hub** (physically laster device) for **star**-shaped topology;
		- 10BASE-T lines;
	- Extentsion:
		- Hierarchical hub (physical layer);
		- Switch (bridge obsolete) (datalink layer): switch has advantage over hub;
		- VLAN: a service;
- Addressing: MAC address (48 bits, 6 x 2 hex)
	- One computer can have 2 Mac addresses;
	- First three octets (24 Bits): OUI (Organizationally Unique Identifier)
	- NIC Vendor assigned: 24 bits
- Technology:
	- Unicast
	- Broadcast (Ethernet FF:FF:FF:FF:FF:FF)

## Network Layer
- Basics:
	- Virtual Circuit v.s. datagram (TCP/IP);
- IP Protocols:
	- Protocols:
		- ARP (Address Resolution); get mac-address from ip;
		- ICMP (Internet Control Message), IGMP (Internet Group Management);
		- DHCP, IGP (Interior Gateway Protocols), EGP (Exterior Gateway Protocols)
	- Classful IP:
		- class A: 1 network id, 3 host id, 0-126, 16M hosts (non-routable 10.0.0.0/8)
			- 0.0.0.0: this; 127.x.x.x: loopback test;
		- class B: 2 network id, 2 host id, 128-191, 64,000 hosts (non-routable 172.16.0.0/12)
		- class C: 3 network id, 1 host id, 192-224, 254 hosts (non-routable 192.168.0.0/16)
		<img src="/CS_Courses/images/classful.png" alt="drawing" width="500"/>
	- A device connected to two networks has two IP addresses (e.g., router);
	- ARP, ARP cache; (RARP reverse-ARP get ip from mac is in DHCP)
	- Protocol Unit Data: **Datagram**
		- Version, Header length, Service Type, Total length
		- Identification, flags, Fragment Offset
		- TTL (Time-to-Live), Protocol, Header Checksum
		- Source IP, Destination IP (will not change during the connection along routing)
		- Options, padding
- Addressing: IP address (4 bytes)
	- IP addresses belong to networks, not to devices attached to the network
	- **Subnet masking**: determine if an IP address exists on the same network
		- 255.255.255.0, 9.100.100.100/24, and op -> 9.100.100
	- CIDR (Classless inter-domain routing), demarcate	
		- **DHCP** (Dynamic Host Configuration Protocol): assign IP to networks
		- E.g. 128.14.35.7/20: (20 1s followed by 12 0s for "and" operation) from 128.14.32.0 (min) to 128.14.47.255 (max)
- **Checking: check the head only**;
- ICMP:
	- **ping** (Packet InterNet Groper): ping mail.sina.com.cn;
- **Routing** selection;
	- Correct; Complete; Robust; Adaptive; Fair; Optimal;
	- Protocols:
		- IGP: link-state routing protocols, distance-vector protocols; (RIP, OSPF, ...)
			- RIP (hop count for distance): for small networks only;
			- OSPF (Open Shortest Path First): distributed, for large networks;
		- EGP: IANA (Internet Assigned Numbers Authority)
			- IANA: distributes IPs
- IPv6;
	- Dual stack; (both IPv4 and IPv6);
	- Tunneling;
- IP Multicast;
	- Multicast router;
- VPN, NAT;
	- VPN (Virtual Private Network);
	- NAT (Network Address Translation)
- Devices:
	- Router
		- Home router: home devices to ISP;
		- Core router (BGP, routers share data with each other)
- Technology:
	- ARP (Address Resolution Protocol)

## Transport Layer
- Basics:
	- Communication between **processes** in hosts; only on **host** computers, no transport layer during transmission;
	- End-to-end is for processes (running programs);
	- Application protocols using **UDP**:
		- DNS, TFTP, RIP, DHCP, SNMP, NFS, IP-phone, streaming, multicast;
	- Application protocols using **TCP**:
		- SMTP, TELNET, HTTP, FTP;
	- **Port**: every process has a different port number;
		<img src="/CS_Courses/images/port.png" alt="drawing" width="400"/>
- **UDP** (User Datagram Protocol):
	- Connection-less;
	- No congestion control;
	- Could be 1-to-many, many-to-1;
	- Only 8 bytes head (TCP 20 bytes);
- **TCP** (Transmission Control Protocol):
	- Connection-oriented;
	- **Socket** defined as {Ip-address : port} (e.g. 192.3.4.5:80)
	- Each TCP connection has {socket1, socket2};
	- Protocol Unit Data: TCP Segment
		- **Source port** (16), **destination port** (16)
		- Sequence no. (32, current seg no.), ACK no. (32, no. of next expected segment)
		- Header len (4), empty (6), control flag (6), Window (16)
		- Checksum (16), Urgent (16)
		- Options (0 or 16), Padding
		- Data payload
	- Stop-and-Wait:
	- **ARQ** (Automatic Repeat reQuest)
- **Checking: data also**;
- Addressing: Port (16-bit, 80 for http)
	- e.g. 10.1.1.100:80 (socket address)
	- Sockets:
		- Process sends/receives messages to/from sockets
- Flow control:
	- Sliding window;
- Congestion control:
- TCP connection:
	- TCP connection (A to B): Three-Way Handshake
		- A to B: SYN
		- B to A: SYN/ACK
		- A to B: ACK
	- TCP connection (A to B): Four-Way Handshake
		- B to A: FIN
		- A to B: ACK
		- A to B: FIN
		- B to A: ACK
	- A summary:\
		<img src="/CS_Courses/images/tcp.png" alt="drawing" width="400"/>
- Technology:
	- Multiplexing
	- Demultiplexing
	- Socket: instantiation of an end-point in a potential TCP connection
		- LISTEN: a tcp socket is ready and listening (server side only)
		- SYN_SENT: synchronization request sent, connection not established yet (client side only)
		- SYN-Received: a socket previously LISTEN received a syn request and sent a SYN/ACK back
		- ESTABLISHED: working order;
		- FIN_WAIT: FIN sent, ACK not received form the other end;
		- CLOSE_WAIT
	- VPNs and Proxies
- Devices:
	- Firewall: a device blocks traffic meeting certain criteria, e.g. port != 80 (can be program, device)

## Application Layer
- Basics:
	- Allows traffic to be directed to specific network applications
	- Protocols (many): http/smtp/DHCP...
	- Protocol Unit Data: messages
	- Addressing: n/a
	- In OSI 7 layer (5,6,7 all Application layer in TCP/IP 5-Layer Model)
		- 6. Presentation layer
		- 5. Session layer
- **DNS** (Domain Name System):
	- A global and highly distributed network services resolves strings of letters into IP addresses
	- Domain: google (used to demarcate where control moves from TLD to an authoritative name server)
	- Standard: RFC 1034, 1035;
	- **UDP**-based;
	- FQDN (Fully qualified domain name): www.google.com
	- TLD (top-level domain):
		- gTLD: .com, .edu, .org, .gov, ...
		- nTLD: .cn, .uk, .us, .de, ...
		- mail.cctv.com: level 1: .com; 2: cctv; 3: mail;
	- Subdomain: www
	- DNS support up to 127 levels of domain in total
	- DNS service (5 kind)
		- Root name server (13)
		- TLD name server
		- Authoritative name server
		- Caching name server (local)
		- Recursive name server
		- **Iterative** v.s. **Recursive** query;
	- Query:\
		<img src="/CS_Courses/images/dns.png" alt="drawing" width="400"/>
- **FTP** (File Transfer Protocol):
	- Protocols: NFS (Network File System); TFTP;
	- NFS: could access a certain position of a remote file, no need to copy the whole big file;
	- TCP-based;
	- 2 TCP connection: 1 for control, 1 for data;
- TELNET: for remote terminal;
	- Rarely used now;
	- RFC 854;
	- Based on TCP;
- **WWW** (World Wide Web):
	- Basics: a distributed hypermedia system, extension to hypertext;
	- Work style: client-server;
	- **URL** (Uniform Resource Locator):
		- protocol://host:port/path (e.g. http://host:port/path)
		- Example: http://www.tsinghua.edu.cn
	- **HTTP** (HyperText Transfer Protocol);
		- Transaction-oriented;
		- based on TCP;
		- Pull;
		- **Stateless** (server maintains no info about client requests)
		- User-server state: cookies, kept on user's host, managed by browser;
			- When user browsed a website with cookie, it saves history;
			- Could be set in privacy;
		- Web caching (installed by ISP):
		- **Proxy server**: Web Cache;\
			<img src="/CS_Courses/images/proxy.png" alt="drawing" width="400"/>
		- HTTP:\
			<img src="/CS_Courses/images/http1.png" alt="drawing" width="400"/>\
			<img src="/CS_Courses/images/http2.png" alt="drawing" width="400"/>\
			<img src="/CS_Courses/images/http3.png" alt="drawing" width="400"/>
	- **HTML** (HyperText Markup Language):
		- Tag: <> </>
		- Mainly used to **show data on browser**;
		- **XML** (Extensible Markup Language):
			- Mainly used to transfer data;
		- **CSS** (Cascading Style Sheet):
	- Search engine:
- Email:
	- Sending: SMTP;
	- Receiving: POP3; IMAP;
	- Email on browser: HTTP first, then SMTP on mail server;\
		<img src="/CS_Courses/images/email.png" alt="drawing" width="400"/>
	- MIME: to transfer non-ASCII (images, sounds, ...)\
		<img src="/CS_Courses/images/mime.png" alt="drawing" width="400"/>
	- Push-based;
- **DHCP** (Dynamic Host Configuration Protocol): assign IP to networks
	- plug-and-play networking;
	- DHCP relay agent;
	- IP is temporary: lease period;
- **SNMP** (Simple Network Management Protocol);
	- SMI
	- MIB
- **System Call**:
	- Unix: socket interface;
	- Windows: WinSock;
	- Working Style:\
		<img src="/CS_Courses/images/socket-1.png" alt="drawing" width="400"/>\
		<img src="/CS_Courses/images/socket-2.png" alt="drawing" width="400"/>\
		<img src="/CS_Courses/images/socket-3.png" alt="drawing" width="400"/>
- Technology:
	- Popular web-servers: Microsoft IIS, Apache, nginx
	- FTP (based on TCP): port 21
	- Streaming (HTTP, RTP) (based on TCP or UDP)
	- Internet Telephone SIP, RTP (Skype) (based on TCP or UDP)
- Devices:
	- Gateway;

## Devices (4 required for modern networks)
- IP Address
- Subnet Mask
- Gateway for a host
- DNS Server

## Concepts
- NAT (Network Address Translation):
	- IP masquerading (One-to-Many NAT, Hide IP of the computer, seems that the data is from the router)
	- Non-Routable Address Space
	- RIP (Regional Internet Registries)
- VPN (Virtual Private Network)
	- A technology allowing for the extension of a private/local network to hosts not on that network
	- **VPN Tunnel**
	- Cisco AnyConnect
- Proxy
	- A server acting on behalf of a client to access another service
	- Reverse proxy: for encryption and decryption?
- DNS
- **ping**: send a special typle of ICMP message called Echo Request (ping 8.8.8.8)
	- Send back a reply
- **TraceRoute** (traceroute google.com)
- **netcat** (nc google.com 80)
- **nslookup** for **DNS** (nslookup twitter.com)
- Cloud Computing
	- Computing resources are provisioned in a shareable way;
	- Virtualization
	- Private cloud, hybrid cloud
- Host files:
	- 127.0.0.1::1 localhost
- IPv6
	- e.g. 2001:0db8:0000:0000:0000:ff00:0012:3456
	- short: 2001:db8:0:0:0:ff00:12:3456 (remove leading 0s)
	- 8 octets: first 4 network ID, next 4 host id

## Connect to Internet
- Telephone:
	- Modem (modulator/demodulator)
	- PSTN (Public switched telephone network)
	- USENET
- Broadband
	- T-carrier technologies;
	- DSL (digital subscriber line): ADSL, SDSL
		- Customer: Inbound >> Outbound (ADSL)
		- SDSL (symmetric), used by business
		- HDSL
	- Fiber connections
- WAN (Wide Area Network)
- Point-to-Point
- Wireless Network
	- Protocols: 802.11 (802.11a, b, g, ac), on physical + datalink layer
	- 2.4 GHz to 5 GHz
	- wireless access point
	- 4 addresses in header (rather than 2)
	- 1. Ad-hoc (connects to each other, most common)
	- 2. Wireless LAN (WLANS)
	- 3. Mesh networks (mixture of 1 and 2)
	- Security: WEP (Wired Equivalent Privacy)
	- Cellular Network (Mobile networking)